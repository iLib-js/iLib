version: 2.1
jobs:
  test:
    docker:
      - image: cimg/openjdk:8.0-node
    steps:
      - checkout

      - run:
          name: Setup
          command: sudo apt-get install -y ant

      - run:
          name: Setup
          command: |
            rm -rf node_modules package-lock.json
            npm install
            echo "node version: " $(node -v)
            echo "npm version: " $(npm -v)
            echo "java version: " $(java --version)
            echo "ant version: " $(ant --version)

      - run:
          name: Running all unit tests
          command: |
            ant test

workflows:
  version: 2
  test-all-node-versions:
    jobs:
      - test
