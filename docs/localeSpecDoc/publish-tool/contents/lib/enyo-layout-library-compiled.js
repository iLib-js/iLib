(function(d){d.kind({name:"enyo.FittableLayout",kind:"Layout",noDefer:!0,constructor:d.inherit(function(a){return function(){a.apply(this,arguments);this.container.addRemoveClass("force-left-to-right",d.Control.prototype.rtl&&!this.container.get("rtl"));(this.useFlex=d.FittableLayout.flexAvailable&&!0===this.container.useFlex)?this.container.addClass(this.flexLayoutClass):this.container.addClass(this.fitLayoutClass)}}),calcFitIndex:function(){var a=this.container.children,b,c;for(c=0;c<a.length;c++)if(b=
a[c],b.fit&&b.showing)return c},getFitControl:function(){var a=this.container.children,b=a[this.fitIndex];if(!b||!b.fit||!b.showing)this.fitIndex=this.calcFitIndex(),b=a[this.fitIndex];return b},shouldReverse:function(){return this.container.rtl&&"h"===this.orient},destroy:d.inherit(function(a){return function(){a.apply(this,arguments);this.container&&this.container.removeClass(this.useFlex?this.flexLayoutClass:this.fitLayoutClass)}}),getFirstChild:function(){var a=this.getShowingChildren();return this.shouldReverse()?
a[a.length-1]:a[0]},getLastChild:function(){var a=this.getShowingChildren();return this.shouldReverse()?a[0]:a[a.length-1]},getShowingChildren:function(){for(var a=[],b=0,c=this.container.children,f=c.length;b<f;b++)c[b].showing&&a.push(c[b]);return a},_reflow:function(a,b,c,f){this.container.addRemoveClass("enyo-stretch",!this.container.noStretch);var e=this.getFitControl(),g=this.container.hasNode(),i=0,j=0,h=0,k;e&&g&&(j=d.dom.calcPaddingExtents(g),k=e.getBounds(),i=g[b]-(j[c]+j[f]),this.shouldReverse()?
(f=this.getFirstChild(),h=i-(k[c]+k[a]),j=d.dom.getComputedBoxValue(f.hasNode(),"margin",c)||0,f!=e&&(f=f.getBounds()[c],j=k[c]+j-f)):(h=this.getLastChild(),j=k[c]-(j[c]||0),f=d.dom.getComputedBoxValue(h.hasNode(),"margin",f)||0,h==e?h=f:(h=h.getBounds(),h=h[c]+h[a]+f-(k[c]+k[a]))),e.applyStyle(a,i-(j+h)+"px"))},flow:function(){if(this.useFlex){var a,b=this.container.children,c;this.container.addClass(this.flexLayoutClass);this.container.addRemoveClass("nostretch",this.container.noStretch);for(a=
0;a<b.length;a++)c=b[a],c.addClass("enyo-flex-item"),c.addRemoveClass("flex",c.fit)}},reflow:function(){this.useFlex||("h"==this.orient?this._reflow("width","clientWidth","left","right"):this._reflow("height","clientHeight","top","bottom"))},statics:{flexAvailable:!1}});d.kind({name:"enyo.FittableColumnsLayout",kind:"FittableLayout",orient:"h",fitLayoutClass:"enyo-fittable-columns-layout",flexLayoutClass:"enyo-flex-container columns"});d.kind({name:"enyo.FittableRowsLayout",kind:"FittableLayout",
fitLayoutClass:"enyo-fittable-rows-layout",orient:"v",flexLayoutClass:"enyo-flex-container rows"});(function(){var a=document.createElement("div");d.FittableLayout.flexAvailable=void 0!==a.style.flexBasis||void 0!==a.style.webkitFlexBasis||void 0!==a.style.mozFlexBasis||void 0!==a.style.msFlexBasis})()})(enyo,this);(function(d){d.kind({name:"enyo.FittableRows",layoutKind:"FittableRowsLayout",noStretch:!1})})(enyo,this);(function(d){d.kind({name:"enyo.FittableColumns",layoutKind:"FittableColumnsLayout",noStretch:!1})})(enyo,this);(function(d){var a=d.HTMLStringDelegate,b=Object.create(a);b.generateInnerHtml=function(c){var b="";c.index=null;for(var d=0,g=0;d<c.count;d++)g=c.rowOffset+(this.bottomUp?c.count-d-1:d),c.setupItem(g),c.$.client.setAttribute("data-enyo-index",g),"h"==c.orient&&c.$.client.setStyle("display:inline-block;"),b+=a.generateChildHtml(c),c.$.client.teardownRender();return b};d.kind({name:"enyo.FlyweightRepeater",kind:"enyo.Control",published:{count:0,noSelect:!1,multiSelect:!1,toggleSelected:!1,clientClasses:"",
clientStyle:"",rowOffset:0,orient:"v"},events:{onSetupItem:"",onRenderRow:""},cachePoint:!0,bottomUp:!1,renderDelegate:b,components:[{kind:"Selection",onSelect:"selectDeselect",onDeselect:"selectDeselect"},{name:"client"}],create:d.inherit(function(a){return function(){a.apply(this,arguments);this.noSelectChanged();this.multiSelectChanged();this.clientClassesChanged();this.clientStyleChanged()}}),noSelectChanged:function(){this.noSelect&&this.$.selection.clear()},multiSelectChanged:function(){this.$.selection.setMulti(this.multiSelect)},
clientClassesChanged:function(){this.$.client.setClasses(this.clientClasses)},clientStyleChanged:function(){this.$.client.setStyle(this.clientStyle)},setupItem:function(a){this.doSetupItem({index:a,selected:this.isSelected(a)})},generateChildHtml:function(){return this.renderDelegate.generateInnerHtml(this)},previewDomEvent:function(a){var b=this.index=this.rowForEvent(a);a.rowIndex=a.index=b;a.flyweight=this},decorateEvent:d.inherit(function(a){return function(b,d,g){var i=d&&null!=d.index?d.index:
this.index;d&&null!=i&&(d.index=i,d.flyweight=this);a.apply(this,arguments)}}),tap:function(a,b){this.noSelect||-1===b.index||(this.toggleSelected?this.$.selection.toggle(b.index):this.$.selection.select(b.index))},selectDeselect:function(a,b){this.renderRow(b.key)},getSelection:function(){return this.$.selection},isSelected:function(a){return this.getSelection().isSelected(a)},renderRow:function(a){if(!(a<this.rowOffset||a>=this.count+this.rowOffset)){this.setupItem(a);var b=this.fetchRowNode(a);
b&&(d.dom.setInnerHtml(b,d.HTMLStringDelegate.generateChildHtml(this.$.client)),this.$.client.teardownChildren(),this.doRenderRow({rowIndex:a}))}},fetchRowNode:function(a){if(this.hasNode())return this.node.querySelector('[data-enyo-index="'+a+'"]')},rowForEvent:function(a){if(!this.hasNode())return-1;for(a=a.target;a&&a!==this.node;){var b=a.getAttribute&&a.getAttribute("data-enyo-index");if(null!==b)return Number(b);a=a.parentNode}return-1},prepareRow:function(a){a<this.rowOffset||a>=this.count+
this.rowOffset||(this.setupItem(a),a=this.fetchRowNode(a),d.FlyweightRepeater.claimNode(this.$.client,a))},lockRow:function(){this.$.client.teardownChildren()},performOnRow:function(a,b,e){if(!(a<this.rowOffset||a>=this.count+this.rowOffset)&&b)this.prepareRow(a),d.call(e||null,b),this.lockRow()},statics:{claimNode:function(a,b){var d;b&&(d=b.id!==a.id?b.querySelector("#"+a.id):b);a.generated=Boolean(d||!a.tag);a.node=d;a.node&&a.rendered();d=0;for(var g=a.children,i;i=g[d];d++)this.claimNode(i,b)}}})})(enyo,
this);(function(d){d.kind({name:"enyo.List",kind:"Scroller",classes:"enyo-list",published:{count:0,rowsPerPage:50,orient:"v",bottomUp:!1,noSelect:!1,multiSelect:!1,toggleSelected:!1,fixedSize:!1,reorderable:!1,centerReorderContainer:!0,reorderComponents:[],pinnedReorderComponents:[],swipeableComponents:[],enableSwipe:!1,persistSwipeableItem:!1},events:{onSetupItem:"",onSetupReorderComponents:"",onSetupPinnedReorderComponents:"",onReorder:"",onSetupSwipeItem:"",onSwipeDrag:"",onSwipe:"",onSwipeComplete:""},
handlers:{onAnimateFinish:"animateFinish",onRenderRow:"rowRendered",ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish",onup:"up",onholdpulse:"holdpulse",onflick:"flick"},rowSize:0,listTools:[{name:"port",classes:"enyo-list-port enyo-border-box",components:[{name:"generator",kind:"FlyweightRepeater",canGenerate:!1,components:[{tag:null,name:"client"}]},{name:"holdingarea",allowHtml:!0,classes:"enyo-list-holdingarea"},{name:"page0",allowHtml:!0,classes:"enyo-list-page"},{name:"page1",allowHtml:!0,
classes:"enyo-list-page"},{name:"placeholder",classes:"enyo-list-placeholder"},{name:"swipeableComponents",style:"position:absolute; display:block; top:-1000px; left:0;"}]}],reorderHoldTimeMS:600,draggingRowIndex:-1,initHoldCounter:3,holdCounter:3,holding:!1,placeholderRowIndex:-1,dragToScrollThreshold:0.1,scrollDistance:0,prevScrollTop:0,autoScrollTimeoutMS:20,autoScrollTimeout:null,autoscrollPageY:0,pinnedReorderMode:!1,initialPinPosition:-1,itemMoved:!1,currentPageNumber:-1,completeReorderTimeout:null,
swipeIndex:null,swipeDirection:null,persistentItemVisible:!1,persistentItemOrigin:null,swipeComplete:!1,completeSwipeTimeout:null,completeSwipeDelayMS:500,normalSwipeSpeedMS:200,fastSwipeSpeedMS:100,percentageDraggedThreshold:0.2,importProps:d.inherit(function(a){return function(b){b&&b.reorderable&&(this.touch=!0);a.apply(this,arguments)}}),create:d.inherit(function(a){return function(){this.pageSizes=[];this.vertical=(this.orientV="v"==this.orient)?"default":"hidden";a.apply(this,arguments);this.$.generator.orient=
this.orient;this.getStrategy().translateOptimized=!0;this.$.port.addRemoveClass("horizontal",!this.orientV);this.$.port.addRemoveClass("vertical",this.orientV);this.$.page0.addRemoveClass("vertical",this.orientV);this.$.page1.addRemoveClass("vertical",this.orientV);this.bottomUpChanged();this.noSelectChanged();this.multiSelectChanged();this.toggleSelectedChanged();this.$.generator.setRowOffset(0);this.$.generator.setCount(this.count)}}),initComponents:d.inherit(function(a){return function(){this.createReorderTools();
a.apply(this,arguments);this.createSwipeableComponents()}}),createReorderTools:function(){this.createComponent({name:"reorderContainer",classes:"enyo-list-reorder-container",ondown:"sendToStrategy",ondrag:"sendToStrategy",ondragstart:"sendToStrategy",ondragfinish:"sendToStrategy",onflick:"sendToStrategy"})},createStrategy:d.inherit(function(a){return function(){this.controlParentName="strategy";a.apply(this,arguments);this.createChrome(this.listTools);this.controlParentName="client";this.discoverControlParent()}}),
createSwipeableComponents:function(){for(var a=0;a<this.swipeableComponents.length;a++)this.$.swipeableComponents.createComponent(this.swipeableComponents[a],{owner:this.owner})},rendered:d.inherit(function(a){return function(){a.apply(this,arguments);this.$.generator.node=this.$.port.hasNode();this.$.generator.generated=!0;this.reset()}}),handleResize:d.inherit(function(a){return function(){a.apply(this,arguments);this.refresh()}}),bottomUpChanged:function(){this.$.generator.bottomUp=this.bottomUp;
this.$.page0.applyStyle(this.pageBound,null);this.$.page1.applyStyle(this.pageBound,null);this.pageBound=this.orientV?this.bottomUp?"bottom":"top":this.rtl?this.bottomUp?"left":"right":this.bottomUp?"right":"left";!this.orientV&&this.bottomUp&&(this.$.page0.applyStyle("left","auto"),this.$.page1.applyStyle("left","auto"));this.hasNode()&&this.reset()},noSelectChanged:function(){this.$.generator.setNoSelect(this.noSelect)},multiSelectChanged:function(){this.$.generator.setMultiSelect(this.multiSelect)},
toggleSelectedChanged:function(){this.$.generator.setToggleSelected(this.toggleSelected)},countChanged:function(){this.hasNode()&&this.updateMetrics()},sendToStrategy:function(a,b){this.$.strategy.dispatchEvent("on"+b.type,b,a)},updateMetrics:function(){this.defaultPageSize=this.rowsPerPage*(this.rowSize||100);this.pageCount=Math.ceil(this.count/this.rowsPerPage);for(var a=this.portSize=0;a<this.pageCount;a++)this.portSize+=this.getPageSize(a);this.adjustPortSize()},holdpulse:function(a,b){if(this.getReorderable()&&
!this.isReordering()&&b.holdTime>=this.reorderHoldTimeMS&&this.shouldStartReordering(a,b))return this.startReordering(b),!1},dragstart:function(a,b){if(this.isReordering())return!0;if(this.isSwipeable())return this.swipeDragStart(a,b)},drag:function(a,b){if(this.shouldDoReorderDrag(b))return b.preventDefault(),this.reorderDrag(b),!0;if(this.isSwipeable())return b.preventDefault(),this.swipeDrag(a,b),!0},dragfinish:function(a,b){this.isReordering()?this.finishReordering(a,b):this.isSwipeable()&&this.swipeDragFinish(a,
b)},up:function(a,b){this.isReordering()&&this.finishReordering(a,b)},generatePage:function(a,b){this.page=a;var c=this.rowsPerPage*this.page;this.$.generator.setRowOffset(c);c=Math.min(this.count-c,this.rowsPerPage);this.$.generator.setCount(c);var d=this.$.generator.generateChildHtml();b.setContent(d);this.getReorderable()&&-1<this.draggingRowIndex&&this.hideReorderingRow();d=b.getBounds();d=this.orientV?d.height:d.width;!this.rowSize&&0<d&&(this.rowSize=Math.floor(d/c),this.updateMetrics());this.fixedSize||
(c=this.getPageSize(a),c!=d&&0<d&&(this.pageSizes[a]=d,this.portSize+=d-c))},pageForRow:function(a){return Math.floor(a/this.rowsPerPage)},update:function(a){var b=!1,a=this.positionToPageInfo(a),a=Math.floor((a.pos+this.scrollerSize/2)/Math.max(a.size,this.scrollerSize)+0.5)+a.no,c=0===a%2?a:a-1;this.p0!=c&&this.isPageInRange(c)&&(this.removedInitialPage=this.removedInitialPage||this.draggingRowPage==this.p0,this.generatePage(c,this.$.page0),this.positionPage(c,this.$.page0),this.p0=c,b=!0,this.p0RowBounds=
this.getPageRowSizes(this.$.page0));c=0===a%2?Math.max(1,a-1):a;this.p1!=c&&this.isPageInRange(c)&&(this.removedInitialPage=this.removedInitialPage||this.draggingRowPage==this.p1,this.generatePage(c,this.$.page1),this.positionPage(c,this.$.page1),this.p1=c,b=!0,this.p1RowBounds=this.getPageRowSizes(this.$.page1));b&&(this.$.generator.setRowOffset(0),this.$.generator.setCount(this.count),this.fixedSize||(this.adjustBottomPage(),this.adjustPortSize()))},getPageRowSizes:function(a){for(var b={},a=a.hasNode().querySelectorAll("div[data-enyo-index]"),
c=0,f,e;c<a.length;c++)f=a[c].getAttribute("data-enyo-index"),null!==f&&(e=d.dom.getBounds(a[c]),b[parseInt(f,10)]={height:e.height,width:e.width});return b},updateRowBounds:function(a){this.p0RowBounds[a]?this.updateRowBoundsAtIndex(a,this.p0RowBounds,this.$.page0):this.p1RowBounds[a]&&this.updateRowBoundsAtIndex(a,this.p1RowBounds,this.$.page1)},updateRowBoundsAtIndex:function(a,b,c){c=c.hasNode().querySelector('div[data-enyo-index="'+a+'"]');c=d.dom.getBounds(c);b[a].height=c.height;b[a].width=
c.width},updateForPosition:function(a){this.update(this.calcPos(a))},calcPos:function(a){return this.bottomUp?this.portSize-this.scrollerSize-a:a},adjustBottomPage:function(){var a=this.p0>=this.p1?this.$.page0:this.$.page1;this.positionPage(a.pageNo,a)},adjustPortSize:function(){this.scrollerSize=this.orientV?this.getBounds().height:this.getBounds().width;this.$.port.applyStyle(this.orientV?"height":"width",Math.max(this.scrollerSize,this.portSize)+"px");this.orientV||this.$.port.applyStyle("height",
this.getBounds().height+"px")},positionPage:function(a,b){b.pageNo=a;var c=this.pageToPosition(a);b.applyStyle(this.pageBound,c+"px")},pageToPosition:function(a){for(var b=0;0<a;)a--,b+=this.getPageSize(a);return b},positionToPageInfo:function(a){for(var b=-1,a=this.calcPos(a),c=this.defaultPageSize;0<=a;)b++,c=this.getPageSize(b),a-=c;b=Math.max(b,0);return{no:b,size:c,pos:a+c,startRow:b*this.rowsPerPage,endRow:Math.min((b+1)*this.rowsPerPage-1,this.count-1)}},isPageInRange:function(a){return a==
Math.max(0,Math.min(this.pageCount-1,a))},getPageSize:function(a){var b=this.pageSizes[a];b||(b=this.defaultPageSize*(Math.min(this.count-this.rowsPerPage*a,this.rowsPerPage)/this.rowsPerPage));return Math.max(1,b)},invalidatePages:function(){this.p0=this.p1=null;this.p0RowBounds={};this.p1RowBounds={};this.$.page0.setContent("");this.$.page1.setContent("")},invalidateMetrics:function(){this.pageSizes=[];this.rowSize=0;this.updateMetrics()},scroll:d.inherit(function(a){return function(b,c){var d=
a.apply(this,arguments),e=this.orientV?this.getScrollTop():this.getScrollLeft();if(this.lastPos===e)return d;this.lastPos=e;this.update(e);this.pinnedReorderMode&&this.reorderScroll(b,c);return d}}),setScrollTop:d.inherit(function(a){return function(b){this.update(b);a.apply(this,arguments);this.twiddle()}}),getScrollPosition:function(){return this.calcPos(this[this.orientV?"getScrollTop":"getScrollLeft"]())},setScrollPosition:function(a){this[this.orientV?"setScrollTop":"setScrollLeft"](this.calcPos(a))},
scrollToBottom:d.inherit(function(a){return function(){this.update(this.getScrollBounds().maxTop);a.apply(this,arguments)}}),scrollToRow:function(a){var b=this.pageForRow(a),c=this.pageToPosition(b);this.updateForPosition(c);c=this.pageToPosition(b);this.setScrollPosition(c);if(b==this.p0||b==this.p1)if(a=this.$.generator.fetchRowNode(a))c=this.orientV?a.offsetTop:a.offsetLeft,this.bottomUp&&(c=this.getPageSize(b)-(this.orientV?a.offsetHeight:a.offsetWidth)-c),this.setScrollPosition(this.getScrollPosition()+
c)},scrollToStart:function(){this[this.bottomUp?this.orientV?"scrollToBottom":"scrollToRight":"scrollToTop"]()},scrollToEnd:function(){this[this.bottomUp?this.orientV?"scrollToTop":"scrollToLeft":this.orientV?"scrollToBottom":"scrollToRight"]()},refresh:function(){this.invalidatePages();this.update(this[this.orientV?"getScrollTop":"getScrollLeft"]());this.stabilize();4===d.platform.android&&this.twiddle()},reset:function(){this.getSelection().clear();this.invalidateMetrics();this.invalidatePages();
this.stabilize();this.scrollToStart()},getSelection:function(){return this.$.generator.getSelection()},select:function(a,b){return this.getSelection().select(a,b)},deselect:function(a){return this.getSelection().deselect(a)},isSelected:function(a){return this.$.generator.isSelected(a)},renderRow:function(a){this.$.generator.renderRow(a)},rowRendered:function(a,b){this.updateRowBounds(b.rowIndex)},prepareRow:function(a){this.$.generator.prepareRow(a)},lockRow:function(){this.$.generator.lockRow()},
performOnRow:function(a,b,c){this.$.generator.performOnRow(a,b,c)},animateFinish:function(){this.twiddle();return!0},twiddle:function(){var a=this.getStrategy();d.call(a,"twiddle")},pageForPageNumber:function(a,b){return 0===a%2?!b||a===this.p0?this.$.page0:null:!b||a===this.p1?this.$.page1:null},shouldStartReordering:function(a,b){return!this.getReorderable()||null==b.rowIndex||0>b.rowIndex||this.pinnedReorderMode||null==b.index||0>b.index?!1:!0},startReordering:function(a){this.$.strategy.listReordering=
!0;this.buildReorderContainer();this.doSetupReorderComponents({index:a.index});this.styleReorderContainer(a);this.draggingRowIndex=this.placeholderRowIndex=a.rowIndex;this.draggingRowPage=this.pageForRow(this.draggingRowIndex);this.removeDraggingRowNode=a.dispatchTarget.retainNode(a.target);this.itemMoved=this.removedInitialPage=!1;this.initialPageNumber=this.currentPageNumber=this.pageForRow(a.rowIndex);this.prevScrollTop=this.getScrollTop();this.replaceNodeWithPlaceholder(a.rowIndex)},buildReorderContainer:function(){this.$.reorderContainer.destroyClientControls();
for(var a=0;a<this.reorderComponents.length;a++)this.$.reorderContainer.createComponent(this.reorderComponents[a],{owner:this.owner});this.$.reorderContainer.render()},styleReorderContainer:function(a){this.setItemPosition(this.$.reorderContainer,a.rowIndex);this.setItemBounds(this.$.reorderContainer,a.rowIndex);this.$.reorderContainer.setShowing(!0);this.centerReorderContainer&&this.centerReorderContainerOnPointer(a)},appendNodeToReorderContainer:function(a){this.$.reorderContainer.createComponent({allowHtml:!0,
content:a.innerHTML}).render()},centerReorderContainerOnPointer:function(a){var b=d.dom.calcNodePosition(this.hasNode()),c=this.$.reorderContainer.getBounds(),f=a.pageX-b.left-parseInt(c.width,10)/2,a=a.pageY-b.top+this.getScrollTop()-parseInt(c.height,10)/2;"ScrollStrategy"!=this.getStrategyKind()&&(f-=this.getScrollLeft(),a-=this.getScrollTop());this.positionReorderContainer(f,a)},positionReorderContainer:function(a,b){this.$.reorderContainer.addClass("enyo-animatedTopAndLeft");this.$.reorderContainer.addStyles("left:"+
a+"px;top:"+b+"px;");this.setPositionReorderContainerTimeout()},setPositionReorderContainerTimeout:function(){this.clearPositionReorderContainerTimeout();this.positionReorderContainerTimeout=setTimeout(this.bindSafely(function(){this.$.reorderContainer.removeClass("enyo-animatedTopAndLeft");this.clearPositionReorderContainerTimeout()}),100)},clearPositionReorderContainerTimeout:function(){this.positionReorderContainerTimeout&&(clearTimeout(this.positionReorderContainerTimeout),this.positionReorderContainerTimeout=
null)},shouldDoReorderDrag:function(){return!this.getReorderable()||0>this.draggingRowIndex||this.pinnedReorderMode?!1:!0},reorderDrag:function(a){this.positionReorderNode(a);this.checkForAutoScroll(a);this.updatePlaceholderPosition(a.pageY)},updatePlaceholderPosition:function(a){a=this.getRowIndexFromCoordinate(a);-1!==a&&(a>=this.placeholderRowIndex?this.movePlaceholderToIndex(Math.min(this.count,a+1)):this.movePlaceholderToIndex(a))},positionReorderNode:function(a){var b=this.$.reorderContainer.getBounds(),
c=b.left+a.ddx,a=b.top+a.ddy,a="ScrollStrategy"==this.getStrategyKind()?a+(this.getScrollTop()-this.prevScrollTop):a;this.$.reorderContainer.addStyles("top: "+a+"px ; left: "+c+"px");this.prevScrollTop=this.getScrollTop()},checkForAutoScroll:function(a){var b=d.dom.calcNodePosition(this.hasNode()),c=this.getBounds();this.autoscrollPageY=a.pageY;a.pageY-b.top<c.height*this.dragToScrollThreshold?(a=100*(1-(a.pageY-b.top)/(c.height*this.dragToScrollThreshold)),this.scrollDistance=-1*a):a.pageY-b.top>
c.height*(1-this.dragToScrollThreshold)?(a=100*((a.pageY-b.top-c.height*(1-this.dragToScrollThreshold))/(c.height-c.height*(1-this.dragToScrollThreshold))),this.scrollDistance=1*a):this.scrollDistance=0;0===this.scrollDistance?this.stopAutoScrolling():this.autoScrollTimeout||this.startAutoScrolling()},stopAutoScrolling:function(){this.autoScrollTimeout&&(clearTimeout(this.autoScrollTimeout),this.autoScrollTimeout=null)},startAutoScrolling:function(){this.autoScrollTimeout=setInterval(this.bindSafely(this.autoScroll),
this.autoScrollTimeoutMS)},autoScroll:function(){0===this.scrollDistance?this.stopAutoScrolling():this.autoScrollTimeout||this.startAutoScrolling();this.setScrollPosition(this.getScrollPosition()+this.scrollDistance);this.positionReorderNode({ddx:0,ddy:0});this.updatePlaceholderPosition(this.autoscrollPageY)},movePlaceholderToIndex:function(a){var b,c;if(!(0>a)){a>=this.count?(b=null,c=this.pageForPageNumber(this.pageForRow(this.count-1)).hasNode()):(b=this.$.generator.fetchRowNode(a),c=b.parentNode);
var d=this.pageForRow(a);d>=this.pageCount&&(d=this.currentPageNumber);c.insertBefore(this.placeholderNode,b);this.currentPageNumber!==d&&(this.updatePageSize(this.currentPageNumber),this.updatePageSize(d),this.updatePagePositions(d));this.placeholderRowIndex=a;this.currentPageNumber=d;this.itemMoved=!0}},finishReordering:function(a,b){if(this.isReordering()&&!this.pinnedReorderMode&&!this.completeReorderTimeout)return this.stopAutoScrolling(),this.$.strategy.listReordering=!1,this.moveReorderedContainerToDroppedPosition(b),
this.completeReorderTimeout=setTimeout(this.bindSafely(this.completeFinishReordering,b),100),b.preventDefault(),!0},moveReorderedContainerToDroppedPosition:function(){var a=this.getRelativeOffset(this.placeholderNode,this.hasNode()),b="ScrollStrategy"==this.getStrategyKind()?a.top:a.top-this.getScrollTop();this.positionReorderContainer(a.left-this.getScrollLeft(),b)},completeFinishReordering:function(a){this.completeReorderTimeout=null;this.placeholderRowIndex>this.draggingRowIndex&&(this.placeholderRowIndex=
Math.max(0,this.placeholderRowIndex-1));this.draggingRowIndex==this.placeholderRowIndex&&this.pinnedReorderComponents.length&&!this.pinnedReorderMode&&!this.itemMoved?this.beginPinnedReorder(a):(this.removeDraggingRowNode(),this.removePlaceholderNode(),this.emptyAndHideReorderContainer(),this.pinnedReorderMode=!1,this.reorderRows(a),this.draggingRowIndex=this.placeholderRowIndex=-1,this.refresh())},beginPinnedReorder:function(a){this.buildPinnedReorderContainer();this.doSetupPinnedReorderComponents(d.mixin(a,
{index:this.draggingRowIndex}));this.pinnedReorderMode=!0;this.initialPinPosition=a.pageY},emptyAndHideReorderContainer:function(){this.$.reorderContainer.destroyComponents();this.$.reorderContainer.setShowing(!1)},buildPinnedReorderContainer:function(){this.$.reorderContainer.destroyClientControls();for(var a=0;a<this.pinnedReorderComponents.length;a++)this.$.reorderContainer.createComponent(this.pinnedReorderComponents[a],{owner:this.owner});this.$.reorderContainer.render()},reorderRows:function(a){this.doReorder(this.makeReorderEvent(a));
this.positionReorderedNode();this.updateListIndices()},makeReorderEvent:function(a){a.reorderFrom=this.draggingRowIndex;a.reorderTo=this.placeholderRowIndex;return a},positionReorderedNode:function(){if(!this.removedInitialPage){var a=this.$.generator.fetchRowNode(this.placeholderRowIndex);a&&(a.parentNode.insertBefore(this.hiddenNode,a),this.showNode(this.hiddenNode));this.hiddenNode=null;if(this.currentPageNumber!=this.initialPageNumber){var b,c;b=this.pageForPageNumber(this.currentPageNumber);
a=this.pageForPageNumber(this.currentPageNumber+1);this.initialPageNumber<this.currentPageNumber?(b=b.hasNode().firstChild,a.hasNode().appendChild(b)):(b=b.hasNode().lastChild,c=a.hasNode().firstChild,a.hasNode().insertBefore(b,c));this.correctPageSizes();this.updatePagePositions(this.initialPageNumber)}}},updateListIndices:function(){if(this.shouldDoRefresh())this.refresh(),this.correctPageSizes();else{var a=Math.min(this.draggingRowIndex,this.placeholderRowIndex),b=Math.max(this.draggingRowIndex,
this.placeholderRowIndex),c,d,e;if(1===(0<this.draggingRowIndex-this.placeholderRowIndex?1:-1)){(c=this.$.generator.fetchRowNode(this.draggingRowIndex))&&c.setAttribute("data-enyo-index","reordered");for(d=b-1;d>=a;d--)if(c=this.$.generator.fetchRowNode(d))e=parseInt(c.getAttribute("data-enyo-index"),10),e+=1,c.setAttribute("data-enyo-index",e);c=this.hasNode().querySelector('[data-enyo-index="reordered"]');c.setAttribute("data-enyo-index",this.placeholderRowIndex)}else{(c=this.$.generator.fetchRowNode(this.draggingRowIndex))&&
c.setAttribute("data-enyo-index",this.placeholderRowIndex);for(d=a+1;d<=b;d++)if(c=this.$.generator.fetchRowNode(d))e=parseInt(c.getAttribute("data-enyo-index"),10),e-=1,c.setAttribute("data-enyo-index",e)}}},shouldDoRefresh:function(){return 1<Math.abs(this.initialPageNumber-this.currentPageNumber)},getNodeStyle:function(a){var b=this.$.generator.fetchRowNode(a);if(b)return a=this.getRelativeOffset(b,this.hasNode()),b=d.dom.getBounds(b),{h:b.height,w:b.width,left:a.left,top:a.top}},getRelativeOffset:function(a,
b){var c={top:0,left:0};if(a!==b&&a.parentNode){do c.top+=a.offsetTop||0,c.left+=a.offsetLeft||0,a=a.offsetParent;while(a&&a!==b)}return c},replaceNodeWithPlaceholder:function(a){var b=this.$.generator.fetchRowNode(a);b?(this.placeholderNode=this.createPlaceholderNode(b),this.hiddenNode=this.hideNode(b),this.pageForPageNumber(this.currentPageNumber).hasNode().insertBefore(this.placeholderNode,this.hiddenNode)):d.log("No node - "+a)},createPlaceholderNode:function(a){var b=this.$.placeholder.hasNode().cloneNode(!0),
a=d.dom.getBounds(a);b.style.height=a.height+"px";b.style.width=a.width+"px";return b},removePlaceholderNode:function(){this.removeNode(this.placeholderNode);this.placeholderNode=null},removeNode:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},updatePageSize:function(a){if(!(0>a)){var b=this.pageForPageNumber(a,!0);if(b){var c=this.pageSizes[a],b=Math.max(1,b.getBounds().height);this.pageSizes[a]=b;this.portSize+=b-c}}},updatePagePositions:function(a){this.positionPage(this.currentPageNumber,
this.pageForPageNumber(this.currentPageNumber));this.positionPage(a,this.pageForPageNumber(a))},correctPageSizes:function(){var a=this.initialPageNumber%2;this.updatePageSize(this.currentPageNumber,this.$["page"+this.currentPage]);a!=this.currentPageNumber&&this.updatePageSize(this.initialPageNumber,this.$["page"+a])},hideNode:function(a){a.style.display="none";return a},showNode:function(a){a.style.display="block";return a},dropPinnedRow:function(a){this.moveReorderedContainerToDroppedPosition(a);
this.completeReorderTimeout=setTimeout(this.bindSafely(this.completeFinishReordering,a),100)},cancelPinnedMode:function(a){this.placeholderRowIndex=this.draggingRowIndex;this.dropPinnedRow(a)},getRowIndexFromCoordinate:function(a){a=this.getScrollTop()+a-d.dom.calcNodePosition(this.hasNode()).top;if(0>a)return-1;var a=this.positionToPageInfo(a),b=a.no==this.p0?this.p0RowBounds:this.p1RowBounds;if(!b)return this.count;for(var c=a.pos,f=this.placeholderNode?d.dom.getBounds(this.placeholderNode).height:
0,e=0,g=a.startRow;g<=a.endRow;++g){if(g===this.placeholderRowIndex&&(e+=f,e>=c))return-1;if(g!==this.draggingRowIndex&&(e+=b[g].height,e>=c))break}return g},getIndexPosition:function(a){return d.dom.calcNodePosition(this.$.generator.fetchRowNode(a))},setItemPosition:function(a,b){var c=this.getNodeStyle(b),c="top:"+("ScrollStrategy"==this.getStrategyKind()?c.top:c.top-this.getScrollTop())+"px; left:"+c.left+"px;";a.addStyles(c)},setItemBounds:function(a,b){var c=this.getNodeStyle(b);a.addStyles("width:"+
c.w+"px; height:"+c.h+"px;")},reorderScroll:function(){"ScrollStrategy"==this.getStrategyKind()&&this.$.reorderContainer.addStyles("top:"+(this.initialPinPosition+this.getScrollTop()-this.rowSize)+"px;");this.updatePlaceholderPosition(this.initialPinPosition)},hideReorderingRow:function(){var a=this.hasNode().querySelector('[data-enyo-index="'+this.draggingRowIndex+'"]');a&&(this.hiddenNode=this.hideNode(a))},isReordering:function(){return-1<this.draggingRowIndex},isSwiping:function(){return null!=
this.swipeIndex&&!this.swipeComplete&&null!=this.swipeDirection},swipeDragStart:function(a,b){if(null==b.index||b.vertical)return!0;this.completeSwipeTimeout&&this.completeSwipe(b);this.swipeComplete=!1;this.swipeIndex!=b.index&&(this.clearSwipeables(),this.swipeIndex=b.index);this.swipeDirection=b.xDirection;this.persistentItemVisible||this.startSwipe(b);this.draggedYDistance=this.draggedXDistance=0;return!0},swipeDrag:function(a,b){if(this.persistentItemVisible)return this.dragPersistentItem(b),
this.preventDragPropagation;if(!this.isSwiping())return!1;this.dragSwipeableComponents(this.calcNewDragPosition(b.ddx));this.draggedXDistance=b.dx;this.draggedYDistance=b.dy;b.xDirection!=this.lastSwipeDirection&&b.xDirection&&(this.lastSwipeDirection=b.xDirection);return!0},swipeDragFinish:function(a,b){if(this.persistentItemVisible)this.dragFinishPersistentItem(b);else if(this.isSwiping())this.calcPercentageDragged(this.draggedXDistance)>this.percentageDraggedThreshold&&this.lastSwipeDirection===
this.swipeDirection?this.swipe(this.fastSwipeSpeedMS):this.backOutSwipe(b);else return!1;return this.preventDragPropagation},isSwipeable:function(){return this.enableSwipe&&0!==this.$.swipeableComponents.controls.length&&!this.isReordering()&&!this.pinnedReorderMode},positionSwipeableContainer:function(a,b){var c=this.$.generator.fetchRowNode(a);if(c){var f=this.getRelativeOffset(c,this.hasNode()),c=d.dom.getBounds(c);this.$.swipeableComponents.addStyles("top: "+f.top+"px; left: "+(1==b?-1*c.width:
c.width)+"px; height: "+c.height+"px; width: "+c.width+"px;")}},calcNewDragPosition:function(a){var b=this.$.swipeableComponents.getBounds().left,c=this.$.swipeableComponents.getBounds(),c=1==this.swipeDirection?0:-1*c.width;return 1==this.swipeDirection?b+a>c?c:b+a:b+a<c?c:b+a},dragSwipeableComponents:function(a){this.$.swipeableComponents.applyStyle("left",a+"px")},startSwipe:function(a){a.index=this.swipeIndex;this.positionSwipeableContainer(this.swipeIndex,a.xDirection);this.$.swipeableComponents.setShowing(!0);
this.setPersistentItemOrigin(a.xDirection);this.doSetupSwipeItem(a)},dragPersistentItem:function(a){this.$.swipeableComponents.applyStyle("left",("right"==this.persistentItemOrigin?Math.max(0,0+a.dx):Math.min(0,0+a.dx))+"px")},dragFinishPersistentItem:function(a){var b=0.2<this.calcPercentageDragged(a.dx);this.persistentItemOrigin==(0<a.dx?"right":0>a.dx?"left":null)?b?this.slideAwayItem():this.bounceItem(a):this.bounceItem(a)},setPersistentItemOrigin:function(a){this.persistentItemOrigin=1==a?"left":
"right"},calcPercentageDragged:function(a){return Math.abs(a/this.$.swipeableComponents.getBounds().width)},swipe:function(a){this.swipeComplete=!0;this.animateSwipe(0,a)},backOutSwipe:function(){var a=this.$.swipeableComponents.getBounds();this.animateSwipe(1==this.swipeDirection?-1*a.width:a.width,this.fastSwipeSpeedMS);this.swipeDirection=null},bounceItem:function(){var a=this.$.swipeableComponents.getBounds();a.left!=a.width&&this.animateSwipe(0,this.normalSwipeSpeedMS)},slideAwayItem:function(){var a=
this.$.swipeableComponents.getBounds().width;this.animateSwipe("left"==this.persistentItemOrigin?-1*a:a,this.normalSwipeSpeedMS);this.persistentItemVisible=!1;this.setPersistSwipeableItem(!1)},clearSwipeables:function(){this.$.swipeableComponents.setShowing(!1);this.persistentItemVisible=!1;this.setPersistSwipeableItem(!1)},completeSwipe:function(){this.completeSwipeTimeout&&(clearTimeout(this.completeSwipeTimeout),this.completeSwipeTimeout=null);this.getPersistSwipeableItem()?this.swipeComplete&&
(this.persistentItemVisible=!0):(this.$.swipeableComponents.setShowing(!1),this.swipeComplete&&this.doSwipeComplete({index:this.swipeIndex,xDirection:this.swipeDirection}));this.swipeDirection=this.swipeIndex=null},animateSwipe:function(a,b){var c=d.now(),f=this.$.swipeableComponents,e=parseInt(f.getBounds().left,10),g=a-e;this.stopAnimateSwipe();var i=this.bindSafely(function(){var a=d.now()-c,h=e+g*Math.min(a/b,1);f.applyStyle("left",h+"px");this.job=d.requestAnimationFrame(i);1<=a/b&&(this.stopAnimateSwipe(),
this.completeSwipeTimeout=setTimeout(this.bindSafely(function(){this.completeSwipe()}),this.completeSwipeDelayMS))});this.job=d.requestAnimationFrame(i)},stopAnimateSwipe:function(){this.job&&(this.job=d.cancelRequestAnimationFrame(this.job))}})})(enyo,this);
